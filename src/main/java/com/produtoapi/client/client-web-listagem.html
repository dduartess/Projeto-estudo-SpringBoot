<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Lista de produtos</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			margin: 20px;
		}
		table {
			border-collapse: collapse;
			width: 100%;
			max-width: 600px;
			margin: 20px 0;
		}
		th, td {
			padding: 10px;
			text-align: left;
		}
		th {
			background-color: #f2f2f2;
		}
		#totalProdutos {
			margin-top: 10px;
			font-weight: bold;
		}
		#erroMensagem {
			margin-top: 10px;
			padding: 10px;
			background-color: #ffebee;
			border-radius: 4px;
		}
	</style>
</head>

<body>
	<h2>Lista de Produtos</h2>
	<table id="produtosTable" border="1">
		<thead>
			<tr>
				<th>ID</th>
				<th>Nome</th>
				<th>Pre√ßo</th>
			</tr>
		</thead>
		<tbody></tbody>
	</table>

	<div id="erroMensagem" style="color: red; display: none;">
		Erro ao buscar produtos. Por favor, tente novamente mais tarde.
	</div>

	<div id="totalProdutos">Total de produtos: 0</div>

	<script>
		function listarProdutos(){
			fetch('http://localhost:8080/produtos')
				.then(response => {
					if(!response.ok){
						throw new Error('Erro na rede: ' + response.status);
					}
					return response.json();
				})
				.then(data => {
					const tableBody = document.getElementById('produtosTable').getElementsByTagName('tbody')[0];
					let totalProdutos = 0;
					data.forEach(produto => {
						const row = tableBody.insertRow();
						const cellId = row.insertCell(0);
						const cellNome = row.insertCell(1);
						const cellPreco = row.insertCell(2);
						cellId.textContent = produto.id;
						cellNome.textContent = produto.nome;
						cellPreco.textContent = produto.preco;
						totalProdutos++;
					});
					document.getElementById('totalProdutos').textContent = 'Total de produtos: ' + totalProdutos;
				})
				.catch(error => {
					console.error('Erro ao buscar produtos: ', error);
					document.getElementById('erroMensagem').style.display = 'block';
				});
		}
		document.addEventListener('DOMContentLoaded', listarProdutos);
	</script>
</body>
</html>